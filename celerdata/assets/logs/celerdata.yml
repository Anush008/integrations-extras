id: celerdata
metric_id: celerdata
backend_only: false
pipeline:
  type: pipeline
  name: CelerData
  enabled: true
  filter:
    query: source:celerdata
  processors:
    - type: grok-parser
      name: Parsing FE Log
      enabled: true
      source: message
      samples:
        - 2024-03-28 10:21:53,960 INFO (main|1)
          [AuthorizationMgr.initBuiltinRoleUnlocked():282] create built-in role
          cluster_admin[-3]
        - 2024-03-28 18:58:43,380 INFO (nioEventLoopGroup-4-3|154)
          [RestBaseAction.handleRequest():73] receive http request.
          url=/api/health
        - I0328 10:22:09.303526  1066 olap_server.cpp:844] try to perform path
          gc by tablet!
        - "I0328 18:39:15.387961   687 daemon.cpp:177] Current memory
          statistics: process(126340128), query_pool(0), load(0),
          metadata(106535), compaction(0), schema_change(0), column_pool(0),
          page_cache(0), update(0), chunk_allocator(0), clone(0),
          consistency(0)"
      grok:
        supportRules: ""
        matchRules: >-
          fe.log %{date("yyyy-MM-dd HH:mm:ss,SSS"):timestamp} %{word:loglevel}
          \(%{data}\|%{number}\)
          \[%{word:class_name}.%{word:method_name}\(\):%{number:file_line}\]
          %{data:message}


          be.info %{regex("\\w"):loglevel}%{date("MMdd HH:mm:ss.SSSSSS"):timestamp}\s+%{number:logger.thread_id} %{data:file_name}\:%{number:file_line}\] %{data:message}
    - type: status-remapper
      name: Define `loglevel` as the official status of the log
      enabled: true
      sources:
        - loglevel
    - type: message-remapper
      name: Define `message` as the official message of the log
      enabled: true
      sources:
        - message
    - type: date-remapper
      name: Define `timestamp` as the official date of the log
      enabled: true
      sources:
        - timestamp
